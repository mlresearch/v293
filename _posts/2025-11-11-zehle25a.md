---
title: 'CAPO: Cost-Aware Prompt Optimization'
openreview: UweaRrg9D0
abstract: Large language models (LLMs) have revolutionized natural language processing
  by solving a wide range of tasks simply guided by a prompt. Yet their performance
  is highly sensitive to prompt formulation. While automatic prompt optimization addresses
  this challenge by finding optimal prompts, current methods require a substantial
  number of LLM calls and input tokens, making prompt optimization expensive. We introduce
  CAPO (Cost-Aware Prompt Optimization), an algorithm that enhances prompt optimization
  efficiency by integrating AutoML techniques. CAPO is an evolutionary approach with
  LLMs as operators, incorporating racing to save evaluations and multi-objective
  optimization to balance performance with prompt length. It jointly optimizes instructions
  and few-shot examples while leveraging task descriptions for improved robustness.
  Our extensive experiments across diverse datasets and LLMs demonstrate that CAPO
  outperforms state-of-the-art discrete prompt optimization methods in 11/15 cases
  with improvements up to 21% in accuracy. Our algorithm achieves better performances
  already with smaller budgets, saves evaluations through racing, and decreases average
  prompt length via a length penalty, making it both cost-efficient and cost-aware.
  Even without few-shot examples, CAPO outperforms its competitors and generally remains
  robust to initial prompts. CAPO represents an important step toward making prompt
  optimization more powerful and accessible by improving cost-efficiency.
layout: inproceedings
series: Proceedings of Machine Learning Research
publisher: PMLR
issn: 2640-3498
id: zehle25a
month: 0
tex_title: 'CAPO: Cost-Aware Prompt Optimization'
firstpage: 18/1
lastpage: 45
page: 18/1-45
order: 18
cycles: false
bibtex_author: Zehle, Tom and Schlager, Moritz and Hei{\ss}, Timo and Feurer, Matthias
author:
- given: Tom
  family: Zehle
- given: Moritz
  family: Schlager
- given: Timo
  family: Hei√ü
- given: Matthias
  family: Feurer
date: 2025-11-11
address:
container-title: Proceedings of the Fourth International Conference on Automated Machine
  Learning
volume: '293'
genre: inproceedings
issued:
  date-parts:
  - 2025
  - 11
  - 11
pdf: https://raw.githubusercontent.com/mlresearch/v293/main/assets/zehle25a/zehle25a.pdf
extras: []
# Format based on Martin Fenner's citeproc: https://blog.front-matter.io/posts/citeproc-yaml-for-bibliographies/
---
